# Dates
набор пользовательских функций для работы с датами.

### [Dates_CurMonthBounds](/Dates/CurMonthBounds)

Возвращает границы указанного месяца.

**Параметры**

`@Month` - номер месяца (1..12)  
`@Year` - номер года
   
Если первым параметром в функцию передана дата (т.е. строка формата ДД.ММ.ГГГГ), то месяц и год берутся из этой даты, а второй параметр игнорируется.
    
Если первый парамер не задан - он принимается равным текущей дате.	
		
**Возвращаемое значение**

Функция возвращает массив из двух значений, определяющих даты первого и последнего дня месяца. 
			
**Примеры использования**
```
@n := $Dates_CurMonthBounds(2,2020)
@ret := catval(@n," - ")
```
Переменной `@ret` будет присвоено значение  "01.02.2020 - 29.02.2020".

```
@n := $Dates_CurMonthBounds()
@ret:=@n[2]
```
В переменной `@ret` будет содержаться дата последнего дня текущего месяца.


### [Dates_CurWeekBounds](/Dates/CurWeekBounds) 
Возвращает границы недели пн-вс, к которой относится указанная дата.

**Параметры**

`@Date` - дата, от которой производится отсчет, по умолчанию - текущая дата.
	
**Возвращаемое значение**

Функция возращает массив из двух значений, определяющих даты понедельника и воскресенья недели. 

**Примеры использования**
```
@n := $Dates_CurWeekBounds("10.02.2021")
@ret := catval(@n," - ")
```
Переменной `@ret` будет присвоено значение  "08.02.2021 - 14.02.2021".

```
@n := $Dates_CurMonthBounds()
@ret := @n[1]
```
В переменной `@ret` будет содержаться дата, на которую выпал понедельник текущей недели.

### [Dates_DayNumber](/Dates/DayNumber)

Функция возвращает номер указанного дня в году.

**Параметры**

`@Date` - дата. По умолчанию - текущая дата.
		
**Возвращаемое значение**

Функция возвращает целое число от 1 до 366, соответствующее порядковому номеру дня в году.

**Примеры использования**
```
@n := $Dates_DayNumber("13.09.2021")
```
Переменной `@n` будет присвоено значение  256.

```
@n := $Dates_DayNumber()
```
Переменной `@n` будет присвоено значение, соответствующее  порядковому номеру текущей даты.

### [Dates_DaysInMonth](/Dates/DaysInMonth)
Функция вычисляет число дней в указанном месяце. 

**Параметры**
`@Month` - номер месяца (1..12)
`@Year` - номер года

Если первым параметром передана дата (строка формата ДД.ММ.ГГГГ), то месяц и год берутся из этой даты, а второй параметр игнорируется.

Если первый парамер не задан - он принимается равным текущей дате.
		
**Возвращаемое значение**

Функция возвращает целое число - количество дней в указанном месяце.
			
**Примеры использования**
```
@n := $Dates_DaysInMonth(2,1987)
```
 Переменной `@n` будет присвоено значение 28 - число дней в феврале 1987 г.
 
 ```
@n := $Dates_DaysInMonth()
```
 Переменной `@n` будет присвоено значение,  соответствующее числу дней в текущем месяце.

### [Dates_DaysInYear](/Dates/DaysInYear)
Функция вычисляет число дней в указанном году.

**Параметры**

`@Year` - номер года

Если в качестве параметра в функцию передана дата (т.е. строка формата ДД.ММ.ГГГГ), то номер года берется из этой даты.  
При вызове функции без параметров возвращается число дней в в текущем году.
		
**Возвращаемое значение**

Функция возвращает целое число, соответствующее количеству дней в указанном году.
			
**Примеры использования**

```
@n := $Dates_DaysInYear(2021)
```
Переменной `@n` будет присвоено значение 365 - число дней в 2021 году.

```
@n := $Dates_DaysInYear("23.03.2020")
```
Переменной `@n` будет присвоено значение 366 - число дней в 2020 году.

```
@n := $Dates_DaysInYear()
```
Переменной `@n` будет присвоено значение, равное числу дней в текущем году.

### [Dates_NextWD](/Dates/NextWD)

Функция возвращает дату, на которую выпадает указанный день недели, следующую после заданной даты.

**Параметры**

`@Weekday` - номер интересующего дня недели (1 - пн, 2- вт, ..., 7 - вс)  
`@StartDate` - дата, от которой производится отсчет, по умолчанию - текущая дата.

**Возвращаемое значение**

Функция возвращает дату в формате "ДД.ММ.ГГГГ". Возвращаемое значение всегда строго больше значения `@StartDate`, иными словами если день недели, заданный первым параметром (`@Weekday`), выпадает на дату, указанную во втрором параметре (`@StartDate`), то к этой дате прибавляется одна неделя.
		
**Примеры использования**

```
@weekend:=$Dates_NextWD(6)
```
В переменной `@weekend` будет содержаться дата следующей (считая от сегодняшнего дня) субботы.


```
@mon:=$Dates_NextWD(1,"31.12.2020") 
```
Переменная `@mon` получит значение, соответствующее дате первого понедельника в 2021 году.

```
@holiday:=$Dates_NextWD(7,"31.03.2021")
```
Переменной `@holiday` будет присвоено значение, соответствующее Дню геолога (первое воскресеье апреля) в 2021 году.

### [Dates_PrevWD](/Dates/PrevWD)

Функция возвращает дату, на которую выпадает указанный день недели, предшествующий заданной дате.

**Параметры**

`@Weekday` - номер интересующего дня недели (1 - пн, 2- вт, ..., 7 - вс)  
`@StartDate` - дата, от которой производится отсчет, по умолчанию - текущая дата.

**Возвращаемое значение**

Функция возвращает дату в формате "ДД.ММ.ГГГГ". Возвращаемое значение всегда строго меньше значения `@StartDate`, иными словами если день недели, заданный первым параметром (`@Weekday`), выпадает на дату, указанную во втрором параметре (`@StartDate`), то от этой даты отнимается одна неделя.
		
**Примеры использования**

```
@sun:=$Dates_PrevWD(7)
```
В переменной `@sun` будет содержаться дата воскресенья предыдущей недели.

```
@deadline:=$Dates_PrevWD(5,"01.01.2021")  
```
В переменной `@deadline` будет содержаться дата последней пятницы в 2020 году.

### [Dates_WeekNumber](/Dates/WeekNumber)
Функция возвращает порядковый номер недели, на которую выпадает указанная дата.

**Параметры**

`@Date` - дата. По умолчанию - текущая дата.
		
**Возвращаемое значение**

Функция возвращает целое число в диапазоне от 1 до 53, соответствующее порядковому номеру недели в году. 

**Примеры использования**
```
@n := Dates_WeekNumber("22.11.2021")
```
Переменной `@n` будет присвоено значение 48.

### [Dates_Weekday](/Dates/Weekday)

Функция возвращает номер дня недели для указанной даты.

**Параметры**

`@date` - дата в формате ДД.ММ.ГГГГ. По умолчанию - текущая дата.

**Возвращаемое значение**

Функция возвращает целое число в диапазоне от 1 до 7: 1 - понедельник; 2 - вторник; ...; 7 - воскресенье.
		
**Примеры использования**

```
if $Dates_WeekDay() = 5 then
	Message("Завтра выходной!",@okcancel)

```



```
@wd:=$Dates_WeekDay("01.01.2024")
```
